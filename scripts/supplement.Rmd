---
title: "Supplemental Figures"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: paper
    toc_depth: 4
---
```{r setup, echo=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

```{r load}
library(here)
library(tidyverse)
library(cowplot)
library(ggpubr)
library(ggridges)
library(sjPlot)

rawdata <- readr::read_csv(here::here("data", "rawdata.csv")) %>%
  dplyr::mutate(strain = factor(strain, levels = c("N2","CB")))
pruneddata <- readr::read_csv(here::here("data", "pruneddata.csv")) %>%
  dplyr::mutate(strain = factor(strain, levels = c("N2","CB")))
```

#### **S1 Fig. Raw measurements of animal size**

```{r S1Fig, fig.height=6, fig.width=10}
raw.length <- rawdata %>%
  dplyr::mutate(hour = as.numeric(timepoint)) %>%
  ggplot() +
  aes(x = hour, y = TOF) +
  geom_jitter(size = 0.01, width = 0.2, alpha = 0.02)+
  scale_x_continuous(breaks = seq(0, 60, 10)) +
  facet_wrap(~strain) +
  ylim(NA,750) +
  labs(x="Time (hours)", y = "Animal Length") +
  theme_cowplot(font_size = 10, rel_small = 8/10) +
  panel_border()

raw.width <- rawdata %>%
  dplyr::mutate(hour = as.numeric(timepoint)) %>%
  ggplot() +
  aes(x = hour, y = norm.EXT) +
  geom_jitter(size = 0.01, width = 0.2, alpha = 0.02)+
  scale_x_continuous(breaks = seq(0, 60, 10)) +
  facet_wrap(~strain) +
  panel_border() +
  labs(x="Time (hours)", y = "Animal Width") +
  theme_cowplot(font_size = 10, rel_small = 8/10) +
  panel_border()


figS1 <- cowplot::plot_grid(raw.length, raw.width, nrow = 2, ncol = 1, align = "hv", labels = "AUTO", label_size = 10)
figS1
```
```{r eval=FALSE, include=FALSE}
ggplot2::ggsave(here::here("figures", "supplement", "S1Fig.png"), plot = figS1, device = "png", width = 7, height = 5, units = "in", dpi = 300)
```


#### **S2 Fig. Gaussian finite mixture modeling of COPAS BIOSORT data**

```{r S2Fig, fig.height=5, fig.width=8}
removed <- dplyr::anti_join(rawdata, pruneddata) %>%
  dplyr::mutate(`Removed ?` = "Yes")

kept <- pruneddata %>%
  dplyr::mutate(`Removed ?` = "No")

total <- dplyr::full_join(removed, kept)

figS2 <- total %>%
  dplyr::filter(replicate == "R02" & timepoint %in% c("01","05",10,15,20,25,30,35,40,45,50)) %>%
  ggplot() +
  aes(x = log(TOF), y = log(EXT), color = `Removed ?`) +
  scale_color_manual(values = c("#BC3C29FF", "#0072B5FF")) +
  geom_jitter(size = 0.1, alpha = 0.5) +
  theme_cowplot(font_size = 10, rel_small = 8/10) +
  facet_wrap(~timepoint, nrow = 3) + panel_border()

figS2  
```
```{r eval=FALSE, include=FALSE}
ggplot2::ggsave(here::here("figures", "supplement", "S2Fig.png"), plot = figS2, device = "png", width = 5, height = 3, units = "in", dpi = 300)
```


#### **S3 Fig. Pruned measurements of animal size**
```{r S3Fig, fig.height=6, fig.width=10}
pruned.length <- pruneddata %>%
  dplyr::mutate(hour = as.numeric(timepoint)) %>%
  ggplot() +
  aes(x = hour, y = TOF) +
  geom_jitter(size = 0.01, width = 0.2, alpha = 0.02)+
  facet_wrap(~strain) +
  #ylim(NA,750) +
  scale_x_continuous(breaks = seq(0, 60, 5)) +
  labs(x="Time (hours)", y = "Animal Length") +
  theme_cowplot(font_size = 10, rel_small = 8/10) +
  panel_border()

pruned.width <- pruneddata %>%
  dplyr::mutate(hour = as.numeric(timepoint)) %>%
  ggplot() +
  aes(x = hour, y = norm.EXT) +
  geom_jitter(size = 0.01, width = 0.2, alpha = 0.02)+
  facet_wrap(~strain) +
  scale_x_continuous(breaks = seq(0, 70, 10)) +
  labs(x="Time (hours)", y = "Animal Width") +
  theme_cowplot(font_size = 10, rel_small = 8/10) +
  panel_border()

figS3 <- cowplot::plot_grid(pruned.length, pruned.width, nrow = 2, ncol = 1, align = "hv", labels = "AUTO", label_size = 10)
figS3
```
```{r eval=FALSE, include=FALSE}
ggplot2::ggsave(here::here("figures", "supplement", "S3Fig.png"), plot = figS3, device = "png", width = 7, height = 5, units = "in", dpi = 300)
```





























